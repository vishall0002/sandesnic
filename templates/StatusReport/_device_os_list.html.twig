{% extends 'bases/base_masters.html.twig' %}
{% block content %}
<h3 class="text-dark">APP Insights
<small class="text-danger">** Beta</small>
</h3>
{% if OU is not null %}
	<h4 class="text-muted">{{ OU.organization.ministry.ministryName ~ ',' ~ OU.organization.organizationName ~ ', ' ~ OU.OUName }}</h4>
{% elseif Organization is not null %}
	<h4 class="text-muted">{{ Organization.ministry.ministryName ~ ' ' ~ Organization.organizationName }}</h4>
{% elseif Ministry is not null %}
	<h4 class="text-muted">{{ Ministry.ministryName }}</h4>
{# {% else %}
	<h4 class="text-muted">All Ministries</h4> #}
{% endif %}
	<div class="row">
		<div class="col-12">
			<div class="card m-1 border-0">
				<div class="card-header text-left">
					<h3 class="card-title m-0 text-left">iOS
					</h3>
				</div>
				{% set notUpdated = iOSTotalCount - currentIosUsersCount %}
				<div class="card-body">
					<div class="row">
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1" {% if OU %}href="{{path('user_list', {'objid':OU.guId,'type':'iosUsers'})}}"{% endif %}>
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-apple fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Total Users
										</span><br/>
										<strong class="h1 text-dark dashboard-value">{{iOSTotalCount}}</strong>
									</div>
								</div>
							</a>
						</div>
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1">
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-apple fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Current Version
										</span><br/>
										<strong class="h1 text-dark dashboard-value">{{curVersionIOS}}</strong>
									</div>
								</div>
							</a>
						</div>
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1" {% if OU %}href="{{path('user_list', {'objid':OU.guId,'type':'iosCurUsers', 'ver':curVersionIOS})}}"{% endif %}>
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-apple fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Current Version Updated
										</span><br/>
										<strong class="h1 text-success dashboard-value">{{currentIosUsersCount}}</strong>
									</div>
								</div>
							</a>
						</div>
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1" {% if OU %}href="{{path('user_list', {'objid':OU.guId,'type':'iosOldVerUsers', 'ver':curVersionIOS})}}"{% endif %}>
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-apple fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Current Version Not updated
										</span><br/>
										<strong class="h1 text-danger dashboard-value">{{notUpdated}}</strong>
									</div>
								</div>
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-12">
			<div class="card m-1 border-0">
				<div class="card-header text-left">
					<h3 class="card-title m-0 text-left">ANDROID</h3>
				</div>
				{% set notUpdated = androidTotalCount - currentAndroidUsersCount %}
				<div class="card-body">
					<div class="row">
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1" {% if OU %}href="{{path('user_list', {'objid':OU.guId,'type':'androidUsers'})}}"{% endif %}>
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-android fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Total Users
										</span><br/>
										<strong class="h1 text-dark dashboard-value">{{androidTotalCount}}</strong>
									</div>
								</div>
							</a>
						</div>
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1">
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-android fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Current Version
										</span><br/>
										<strong class="h1 text-dark dashboard-value">{{curVersionAndroid}}</strong>
									</div>
								</div>
							</a>
						</div>
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1" {% if OU %}href="{{path('user_list', {'objid':OU.guId,'type':'androidCurUsers', 'ver':curVersionAndroid})}}"{% endif %}>
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-android fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Current Version Updated
										</span><br/>
										<strong class="h1 text-success dashboard-value">{{currentAndroidUsersCount}}</strong>
									</div>
								</div>
							</a>
						</div>
						<div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-xs-12 mb-2">
							<a class="card p-1" {% if OU %}href="{{path('user_list', {'objid':OU.guId,'type':'androidOldVerUsers', 'ver':curVersionAndroid})}}"{% endif %}>
								<div class="row pl-4">
									<div class="text-right pr-0 pt-1">
										<i class="fa fa-android fa-4x" style="color: hsl(206, 75%, 30%)"></i>
									</div>
									<div class="col-7 text-left pl-0">
										<span class="text-muted dashboard-label">
											Current Version Not updated
										</span><br/>
										<strong class="h1 text-danger dashboard-value">{{notUpdated}}</strong>
									</div>
								</div>
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-6">
			<div class="card m-1">
				<div class="card-header text-left">
					<h3 class="card-title m-0">OS</h3>
				</div>
				<div class="card-body" {% if OSList > 0 %} style="height:283px;overflow-y:auto;" {% endif %}>
					{% if OSList > 0 %}
						<table class="table table-striped table-bordered table-hover table-sm">
							<thead>
								<th>#</th>
								<th>OS</th>
								<th>Count</th>
								{% if OU is not null %}
									<th>View</th>
								{% endif %}
							</thead>
							<tbody>
								{% for record in OSList %}
									<tr>
										<td>{{loop.index}}</td>
										<td>{{record.os | upper ~' - '~record.os_version | upper}}</td>
										<td>{{record.count}}</td>
										{% if OU is not null %}
											<td>
												<a href="{{path('user_list', {'objid':OU.guId,'type':'os', 'ver':record.os ~'-'~ record.os_version})}}" data-objid="{{OU.guId}}">
													<button class="btn btn-primary btn-xs pull-right text-white">
														View
													</button>
												</a>
												{# <a href="{{path('user_list', {'type':'os', 'ver':record.os ~'-'~ record.os_version})}}">
													<input type="hidden" name="objid" class="hdn-data-objid" value="{{OU.guId}}"/>
													<button class="btn btn-primary btn-xs pull-right text-white">
														View
													</button>
												</a> #}
											</td>
										{% endif %}
									</tr>
								{% endfor %}
							</tbody>
						</table>
					{% else %}
                		<h5 class="bg-info text-white text-center">No Users Found</h5>
            		{% endif %}
				</div>
			</div>
		</div>
		<div class="col-6">
			<div class="card m-1">
				<div class="card-header text-left">
					<h3 class="card-title m-0 text-left">App Version</h3>
				</div>
				<div class="card-body" {% if VersionList > 0 %} style="height:283px;overflow-y:auto;" {% endif %}>
					{% if VersionList > 0  %}
						<table class="table table-striped table-bordered table-hover table-sm">
							<thead>
								<th>#</th>
								<th>OS</th>
								<th>App Version</th>
								<th>Count</th>
								{% if OU is not null %}
									<th>View</th>
								{% endif %}
							</thead>
							<tbody>
								{% for record in VersionList %}
									<tr>
										<td>{{loop.index}}</td>
										<td>{{record.os | upper}}</td>
										<td>{{record.app_version | upper}}</td>
										<td>{{record.count}}</td>
										{% if OU is not null %}
											<td>
												<a href="{{path('user_list', {'objid':OU.guId,'type':'appVersion', 'ver':record.os ~'-'~ record.app_version})}}">
													<button class="btn btn-primary btn-xs pull-right text-white">
														View
													</button>
												</a>
											</td>
										{% endif %}
									</tr>
								{% endfor %}
							</tbody>
						</table>
					{% else %}
                		<h5 class="bg-info text-white text-center">No Users Found</h5>
            		{% endif %}
				</div>
			</div>
		</div>
		<div class="col-6">
			<div class="card m-1">
				<div class="card-header text-left">
					<h3 class="card-title m-0 text-left">Device Brand</h3>
				</div>
				<div class="card-body" {% if VersionList > 0 %} style="height:283px;overflow-y:auto;" {% endif %}>
					{% if BrandList > 0 %}
						<table class="table table-striped table-bordered table-hover table-sm">
							<thead>
								<th>#</th>
								<th>Device Brand</th>
								<th>Count</th>
								{% if OU is not null %}
									<th>View</th>
								{% endif %}
							</thead>
							<tbody>
								{% for record in BrandList %}
									<tr>
										<td>{{loop.index}}</td>
										<td>{{record.manufacturer | upper}}</td>
										<td>{{record.count}}</td>
										{% if OU is not null %}
											<td>
												<a href="{{path('user_list', {'objid':OU.guId, 'type':'deviceBrand', 'ver':record.manufacturer})}}">
													<button class="btn btn-primary btn-xs pull-right text-white">
														View
													</button>
												</a>
											</td>
										{% endif %}
									</tr>
								{% endfor %}

							</tbody>
						</table>
					{% else %}
						<h5 class="bg-info text-white text-center">No Users Found</h5>
					{% endif %}
				</div>
			</div>
		</div>
	</div>
{% endblock %}
